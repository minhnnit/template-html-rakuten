!function(){var e=$("#signUpForm"),s=$(".start-shop-btn"),r=0,a=$("#backgroundPopup"),o=$("#showrefer"),t=$("#overlay"),i=$("#shoprow",e),n=$("#passwordrow",e),l=$("#referral_email_address",e),d={noEmail:"Oops! You forgot to enter your Email Address. Please enter it before continuing.",invalidEmail:"Oops! Your Email Address does not appear to be formatted correctly. Please re-enter it before continuing.",noPassword:"Oops! You forgot to enter your Password. Please enter it before continuing.",invalidPassword:"Oops! Your Password must contain between 6 and 256 characters. Please re-enter it before continuing.",invalidRefEmail:"Oops! Your Referral Email Address does not appear to be formatted correctly. Please re-enter it before continuing.",passwordRequired:"An account already exists with that email address. Please enter your password to sign in.",accountExistsInSem:"Oops. The email address already exists. Please try again or sign in.",captchaEmpty:"Please Enter the verification code."},c=function(r,a,o){return s.removeClass("disabled"),$(".error",e).remove(),a.append($("<div id='errorMessage'>").addClass("error "+o).html(r)),e.trigger("err-msg"),!0},u=function(){a.fadeOut("slow"),t.fadeOut("slow",function(){t.remove(),$(document).trigger("overlay-closed")})},p=function(){var s=$("#password",e).val(),r=jQuery.trim($("#email_address",e).val()),a=$("#captcha",e).val(),o=$("#captcha-field",e);if(!r)return c(d.noEmail,i,"empty"),!1;if(!ebates.regex.email.test(r))return c(d.invalidEmail,i,"invalid"),!1;if(n.is(":visible")&&(!s||s.length<6||s.length>256)){if(!s)return c(d.noPassword,n,"empty"),!1;if(s.length<6||s.length>256)return c(d.invalidPassword,n,"invalid"),!1}return $("#captcha").length>0&&0===a.length?(c(d.captchaEmpty,o,"invalid"),!1):!$("#recaptcha").is(":visible")||0!==grecaptcha.getResponse().length||($("#gcap-error").show(),!1)},h=function(){var s=jQuery.trim($(this).val()),r=$(this).hasClass("placeholder-wraped")?$(this).parent():$(this),a=e.find(".error.be-invalid");if(s&&e.find(".error").length)return a.length?void a.remove():r.siblings(".empty").length?void r.siblings(".empty").remove():void(($(this).hasClass("email-address")&&ebates.regex.email.test(s)||$(this).hasClass("password")&&s.length>=6&&s.length<=256)&&r.siblings(".error").remove())},m=function(){if(!s.hasClass("disabled")){var r=window.location.port,a=window.location.hostname,o=("localhost"===a&&"http://"||"https://")+a+(r&&":"+window.location.port)+e.attr("action");p()&&s.addClass("disabled")&&$.ajax(o,{type:"POST",data:e.serialize()+"&isAjax=true",error:function(){window.location.href="/auth/getLogonForm.do"},success:function(r){var a=$("#shoprow",e),o=$("#referral",e);$("#captcha",e);if(r&&"fail"===r.status){if($("#captcha").length>0&&getCaptcha(),$("#recaptcha").length>0&&(grecaptcha.reset(),$("#gcap-error").hide()),s.removeClass("disabled"),"\r\nOops. Please provide a valid email address for your friend. If no one referred you, please leave the field blank.\r\n\r\n"===r.message)return c(r.message,o,"be-invalid"),!1;if("Your account is currently unavailable. Please contact Customer Care for assistance."===r.message){return c("Your account is currently unavailable. Please <a href='/help/customer_care/other.htm?cchelp=true'>Contact Customer Care</a> for assistance.",a,"be-invalid"),!1}if("Oops. The email address already exists. Please try again or sign in."===r.message&&$("input[name='autoGeneratePassword']").val())return"sem-merchant-landing"!==overlayType&&n.length?($("input[name='autoGeneratePassword']").val(""),n.show(),$("#referralhidden").hide(),$("#password","#signUpForm").focus().removeClass("inputblur"),c(d.passwordRequired,n,"be-invalid"),!1):(c(d.accountExistsInSem,a,"be-invalid"),!1);if(r.message)return c(r.message,a,"be-invalid"),!1;c(messages.emailInvalid,a,"")}else r&&"success"===r.status&&("merchant-shopping"===overlayType?window.location=shopUrl:window.location.reload())},xhrFields:{withCredentials:!0},crossDomain:!0})}};t.on("click","#disable",u),a.css({opacity:"0.8"}).fadeIn("slow").click(a.hasClass("notcloseable")?$.noop:u),jQuery.browser.msie&&jQuery.browser.version<=9&&($("input[name='autoGeneratePassword']").val()?e.attr("action","/saveNewUserInfosWithOnlyEmail.do"):e.attr("action","/saveNewUserInfos.do")),$("body").on("click",".start-shop-btn",function(){if(!(jQuery.browser.msie&&jQuery.browser.version<=9))return m(),!1;s.hasClass("disabled")||p()&&s.addClass("disabled")&&e.submit()}),e.on("keypress",function(r){if(13===r.keyCode&&$("input#start-shop").hasClass("next"))return $("#passwordrow").show(),setTimeout(function(){$("#start-shop").removeClass("next").addClass("start-shop-btn")},400),$("#password","#signUpForm").focus().removeClass("inputblur"),$("#start-shop").val("Join"),!1;if(13===r.keyCode){if(!(jQuery.browser.msie&&jQuery.browser.version<=9))return m(),!1;if(s.hasClass("disabled"))return;p()&&s.addClass("disabled")&&e.submit()}}),e.on("input propertychange","input",function(){r&&clearTimeout(r),r=setTimeout($.proxy(h,this),200)}),$("#email_address","#signUpForm").focus().removeClass("inputblur"),$(".next").click(function(){$("#passwordrow").show(),setTimeout(function(){$("#start-shop").removeClass("next").addClass("start-shop-btn")},400),$("#start-shop").val("Join"),$("#password","#signUpForm").focus().removeClass("inputblur")}),o.click(function(){$("#referralhidden").remove(),$("#referral").show(function(){l.focus()})}),o.keypress(function(e){13===(e.keyCode||e.which)&&o.click()}),$("a#terms").click(function(){loadwindowterms("/help/terms_and_conditions_popup.htm",$(this))}),$("a#privacy").click(function(){loadwindowprivacy("/help/privacy_popup.htm",$(this))}),$(".close").click(function(){$(this).parent().hide()})}();
//# sourceMappingURL=validate.1.1.5.min.js.map
