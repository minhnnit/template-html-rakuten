"use strict";!function(){$(document).ready(function(){function e(e){$(document).trigger("stats",{data:[],map:{external:e}})}function t(){$(window).scrollTop()>500&&(e({ec:"Desktop Store Page",el:o,ea:"Scroll Below Fold"}),$(window).off("scroll",t))}function a(e){var t,a=!0,s=0,n=0,r=function(e){l.trigger("stats",{data:["send","event","Desktop Store Page",e],map:{external:{ec:"Desktop Store Page",ea:e,el:o}}})};try{document.querySelector(":-webkit-autofill")}catch(o){a=!1,e.on("input",".susi-email-field input",function(){s++}).on("input",".susi-password-field input",function(){n++}).on("click",".submit-button",function(){s<=3&&ebates.regex.email.test(e.find(".susi-email-field input").val())&&r("Email Autofill"),t=e.find(".susi-password-field input"),t.length>0&&n<=3&&t.val().length>6&&r("Password Autofill")})}e.one("input",".susi-email-field input",function(e){r("Email Insert Text"),a&&setTimeout(function(){e.target.matches(":-webkit-autofill")&&r("Email Autofill")},100)}).one("focus",".susi-email-field input",function(){r("Email Focus")}).one("focus",".susi-password-field input",function(){r("Password Focus")}).one("input",".susi-password-field input",function(e){r("Password Insert Text"),a&&setTimeout(function(){e.target.matches(":-webkit-autofill")&&r("Password Autofill")},100)})}var o=$(".eb-merchant-name").attr("data-attr-mid"),s=[{sel:".hero-fav>div",ec:"Desktop Store Page",ea:"Favorite - Click",el:""},{sel:'a[data-click-action="Click main shop now button"]',ec:"Desktop Store Page",ea:"Left Rail Shop Now - Click",el:""},{sel:'a[data-click-action="Click coupon shop now cta"]',ec:"Desktop Store Page",ea:"Coupon Shop Now - Click",el:""},{sel:".coupon-code",ec:"Desktop Store Page",ea:"Code - Click",el:""},{sel:".in-store a",ec:"Desktop Store Page",ea:"Get ISCB - Click",el:""},{sel:".sl-su-modal .fb-join",ec:"Desktop Store Page",ea:"Facebook - Click",el:""},{sel:".sl-su-modal .google-join",ec:"Desktop Store Page",ea:"Google - Click",el:""},{sel:".sl-su-modal .susi-refer a",ec:"Desktop Store Page",ea:"Did someone refer you? - Click",el:""},{sel:'.sl-su-modal [data-href="/ajax/signin.htm"]',ec:"Desktop Store Page",ea:"Member Sign In - Click",el:""},{sel:".sl-su-modal .eb-modal-close",ec:"Desktop Store Page",ea:"Modal Close - Click",el:""},{sel:"#join-module",ec:"Desktop Store Page",ea:"Join Today Banner - Click",el:""},{sel:".skinny-su-modal .join-button",ec:"Global Sign Up",ea:"Skinny Join Now - Click",el:""},{sel:".skinny-si-modal .join-button",ec:"Global Sign In",ea:"Skinny Sign In - Click",el:""},{sel:"#footer-join .footer-join-now a",ec:"Global Footer",ea:"Footer Join Now - Click",el:""},{sel:"#footer-join .footer-sign-in a",ec:"Global Footer",ea:"Footer Member Sign In - Click",el:""},{sel:".logo3 a",ec:"Global Nav",ea:"Ebates Logo - Click",el:""},{sel:"#merchant-category-module .cat-img a,#merchant-category-module .cat-info a",ec:"Desktop Store Page",ea:"Cash Back Categories Right Rail - Click",el:""},{sel:'a[data-click-action="Click cash back department links"]',ec:"Desktop Store Page",ea:"Cash Back Categories Left Rail - Click",el:""},{sel:'a[data-click-action="Click other departments links"]',ec:"Desktop Store Page",ea:"Categories Without Cash Back - Click",el:""},{sel:'a[data-click-action="Click left rail banners"]',ec:"Desktop Store Page",ea:"Image Ad - Click",el:""},{sel:'a[data-click-action="Click free shipping module link"]',ec:"Desktop Store Page",ea:"Free Shipping - Click",el:""},{sel:'a[data-click-action="Click recommended stores module link"]',ec:"Desktop Store Page",ea:"Recommended Stores - Click",el:""},{sel:".store-hero-image>a",ec:"Desktop Store Page",ea:"Top Banner - Click",el:""},{sel:".eb-form-Store-Overlays .submit-button",ec:"Desktop Store Page",ea:"Join Now - Click",el:""}],n=$(".cb-was").html(),r=$(".cb-amounts a.cb");if(n&&-1!=n.indexOf("was")){e({ec:"Store landing page",ea:"Store has double cashback"})}r.length>0&&""===r.html()&&ebates.stats&&ebates.stats.sendDataError({message:"CashBack missing",label:{Merchants:$(".eb-merchant-name").html()}}),e({ec:"Desktop Store Page",el:o,ea:"Pageview"});for(var i=0;i<s.length;i++)$(s[i].sel).attr("data-event-signature","ec,ea,el").attr("data-el",o).attr("data-ec",s[i].ec).attr("data-ea",s[i].ea);$(document).on("overlay-loaded",function(){setTimeout(function(){for(var e=0;e<s.length;e++)$(s[e].sel).attr("data-event-signature","ec,ea,el").attr("data-el",o).attr("data-ec",s[e].ec).attr("data-ea",s[e].ea)},1e3)}),$("#store_name").one("click",function(){e({ec:"Global Nav",el:o,ea:"Header Search Focus - Click"})}),$("input.email-address").one("focus",function(){e({ec:"Desktop Store Page",el:o,ea:"Email Focus"})}).one("input",function(){e({ec:"Desktop Store Page",el:o,ea:"Email Insert Text"})}),$(".eb-form-layout form").on("err-msg",function(){e({ec:"Desktop Store Page",el:o,ea:"Error Message"})});var l=$(document);$(".eb-form-Store-Overlays form").length>0?a($(".eb-form-Store-Overlays form")):l.one("auth-form-init-done",function(){a($(".eb-form-Store-Overlays form"))}),$("#main-nav li a,.user li a").attr("data-event-signature","ec,ea,el").attr("data-el",o),$(window).on("scroll",t)}),$(document).ready(function(){function e(e,t){var a=new RegExp("("+e.replace(/\\/g,"\\s+")+")","gi");return t.replace(a,'<span class="f-orange">$1</span>')}function t(){var t=$(".cb-amounts a.button"),o=$(".store-cb-terms p:first-of-type").html();if(o||$("#shop-now+.cb-facts h2").html()&&"Cash Back Terms"===$("#shop-now+.cb-facts h2").html().trim()&&(o=$("#shop-now+.cb-facts h2+p").html()),o){o=o.trim();var s=["a few days","14 days","a week","a couple of weeks","a month","six weeks","3 months","6 months","45 days","today","tomorrow","one week","a few weeks","a few months"];if(t.length>0){for(var n=0;n<s.length;n++)o.indexOf(s[n])>0&&(o=e(s[n],o));t.after('<div class="store-cb-tooltip bounce-tooltip pos-abs bg-w pad-30 pad-35-b">\n    <div class="f-16 lh-20 prox-b mar-10-b">Just click and shop!</div>\n    <div class="lh-18 w-202 mar-10-b mar-15-r">To earn Cash Back, click "Shop Now," then, just shop as you normally would.</div>\n    <div class="lh-18 w-202 mar-10-b mar-15-r">'+o+'</div>\n    <div><span class="f-grn pointer close lh-17">GOT IT</span></div>\n</div>')}$("body").on("click",'.store-cb-tooltip .close,a[data-click-action="Click main shop now button"],a[data-click-action="Click coupon shop now cta"]',function(){$(".store-cb-tooltip").remove(),ebates.isLocalstorageAvailable()?localStorage.setItem(a,2):ebates.cookie.set(a,2,90)})}}var a="slp_tooltip_dt",o=["1","2946","3993","10634","9388","3930","4528"];ebates.user&&"REGISTERED_NON_SHOPPER"===ebates.user.status&&dataLayer&&dataLayer[0]&&$('a[data-ea="Left Rail Shop Now - Click"]').length>0&&-1===o.indexOf(dataLayer[0].merchant_id)&&(!ebates.isLocalstorageAvailable()||localStorage.getItem(a)||localStorage.getItem("efsp")?ebates.isLocalstorageAvailable()||ebates.cookie.get(a)||ebates.cookie.get("efsp")||t():t())}),$(function(){function e(){$("div#divisionname_popup").hide(),$("#change-st-bg").css({display:"none"})}var t=(ebates.button.browser,$("input[name='predictive-nmb']")),a=$(".cc-block, .cc-ls-block"),o=$(".fav-lg,.fa-heart").attr("data-click-label"),s=function(){var e,t;e=jQuery("#email_subscribe").is(":visible")?$("#email_subscribe"):$("#subscribe-rt"),$(".dialog, #backgroundPopup").not(".permanent, .cached").fadeOut(2e3,function(){$(this).remove()}),$(document).trigger("stats",{data:["send","event","Store Page","Click email subscribe banner",o]}),$("#subscribeMail").remove(),t="//static.ebates.com/static/images/store/subscribed-store-page.png",e.find("div.subscribe").append("<img src='"+t+"' class='bblk' />"),setTimeout(function(){e.hide()},3e3)},n=function e(){ebates.UI.isInView(document.querySelector(".btn-container"))&&($(document).trigger("stats",{map:{amp:{eventType:"View Module",eventProps:{module_type:"Rail Ad",module_name:"Button"}}}}),$(window).off("scroll",e))};if($("body").on("click","#subscribeMail",function(e,t){return(!t||!t.doNothing)&&(jQuery.post("/saveUserSubscriptionAction.do?subscriptionMail=hotDeals&status=true").done(s),!1)}),!(ebates.user&&ebates.user.loggedIn)&&ebates.js.require(ebates.src.store.overlay),ebates.js.require(ebates.src.expander2,function(){$(".store-cashback-terms .expandablediv").expander2({text:"See",more:" More",less:" Less",lines:8}),$(".store-cb-terms .expandablediv").expander2({text:"See",more:" More",less:" Less",lines:10}),$(".two-lines").not(".merch-desc .two-lines").expander2({text:"See",more:" More",less:" Less",lines:2}),$(".five-lines, .store-info .merch-desc").expander2({text:"See",more:" More",less:" Less",lines:5}),$(".merch-desc .two-lines").expander2({text:"See",more:" More",less:" Less",lines:2})}),t.length&&$(document).trigger("stats",{data:["send","event","Predictive NMB",t.data("merchant"),t.data("member")]}),a.length&&$(function(){var e=$(window),t=a.hasClass("pre-approved")&&"Pre-approved"||"Cardholder",o=function(t,a){var o=e.scrollTop(),s=t.offset().top,n=a||0;return s+t.height()<o+e.height()+n&&s>o-n},s=function(e,t){var a=["send","event","Credit Card",e];return void 0!==t&&a.push(t),$(document).trigger("stats",{data:a}),!0},n=function n(){o(a,50)&&s("Block View - Store",t)&&e.off("scroll-throttle",n)};a.on("click",".learn-more",$.proxy(s,null,"Learn More","Merchant Page | "+location.pathname)).filter(".cardholder").on("click","a.cc-shopping",$.proxy(s,null,"Store tile click - "+a.data("cb")+"%",a.data("merch"))).on("click","a.cc-apply",$.proxy(s,null,"Apply","Store")),s("Block Loaded - Store",t),e.on("scroll-throttle",n)}),$(".store-info").one("click",".expander",function(){$(document).trigger("stats",{data:["send","event","UI","Merchant Read More",location.pathname]})}),($("#left-blk.v1")||1!=$("#amexuser").length)&&$(document).one("button-sf",function(){ebates.js.require(ebates.src.button,function(){var e=$(".eb-merchant-name").data("attr-mid"),t=$(".eb-merchant-name").text(),a=ebates.button.getListing("merchant_page_rail").extensionURL,o='href="'+a+'" target="_blank" data-navigation-id="22874" data-amp-evt-type="Click Button" data-amp-evt-sig="module_name,module_type,store_id,store_name" data-amp-module_name="Button" data-amp-module_type="Rail Ad" data-amp-store_id="'+e+'" data-amp-store_name="'+t+'"',s=$('<div class="aside-blk btn-container">\n\t\t\t\t\t\t\t<h2>Never Miss Cash Back or Coupons</h2>\n\t\t\t\t\t\t\t<p>The Rakuten Cash Back Button is a free browser extension that notifies you of Cash Back and coupons at over 2,500 stores.</p>\n\t\t\t\t\t\t\t<a '+o+' class="get-button button secondary ghost">Get the Button</a>\n                            <a '+o+'>\n                                <img src="//static.ebates.com/static/images/store/landing/left/rak/button_upsell.png" width="293" height="129" class="bblk pad-20-lr">\n                            </a>');s.find("a").on("click",function(){ebates.button.setInstallSource({utm:"merchant_page_rail"})}),$("#left-blk.v1, #right-blk").append(s),$(window).on("scroll",n)})}),setTimeout(function(){$("#email_address").each(function(){$(this).val()&&($("#passwordrow").show(),$("input[name='autoGeneratePassword']").val(""))})},10),ebates.user&&ebates.user.loggedIn){var r=$(".eb-merchant-name").data("attr-mid"),i=$(".eb-merchant-name").data("attr-cs"),l=$("body").hasClass("new-ui")?"&style=r4":"",c="Rakuten"===ebates.rakutenmode.currentBrandName,d="//static.ebates.com/static/images/store/landing/right/inbox-smile-rakuten.jpg",u=$("#right-blk").hasClass("tiered"),m=$("#right-blk").hasClass("tiered-premium");setTimeout(function(){$.ajax({url:"/ajax/stores/udata.htm",data:"merchant_id="+r+"&coupons_size="+i+l,type:"GET",error:function(e,t){console.log(t+" ::: store landing page ajax call")},success:function(e){var t=$(e).filter("#welcome-bonus"),a=$(e).filter("#subscribe-rt"),o=$(e).filter("#return-bonus"),s=$(e).filter("#target_cb_module"),n=$(e).filter("#cc_module");if(c){a.detach().find("img").attr("src",d)}if(t.length>0&&i>0&&4528!=r&&9388!=r&&1!=r){var l=t.detach();$(u)||$(m)?l.insertBefore("#coupons"):$(".green-bar:first").size()>0?l.insertBefore(".green-bar:first"):l.insertAfter("#coupons")}else if(1!=r){var l=t.detach();$("#welcome-bonus-mod").html(l)}if(o.length>0&&i>0){var b=o.detach();3993==r&&$(".lp-categories").size()>0?(b.insertBefore(".lp-categories"),$("#return-bonus").removeClass("mar-10-t")):$("#return-bonus-mod").is(":visible")?$("#return-bonus-mod").html(b):($(u)||$(m)?l.insertBefore("#coupons"):$(".green-bar:first").size()>0?b.insertBefore(".green-bar:first"):b.insertAfter("#coupons"),$("#return-bonus").addClass("mar-10-t").removeClass("mar-10-b"))}else{var b=o.detach();$("#return-bonus-mod").is(":visible")&&$("#return-bonus-mod").html(b)}if(a.length>0&&i>0&&10634!=r&&4528!=r&&9388!=r&&1!=r){var p=a.detach(),h=$("#coupons"),f=$(".cat-header");$(u)||$(m)?p.insertBefore("#coupons"):$(".green-bar:first").size()>0?p.insertBefore(".green-bar:first"):1===f.length?p.appendTo(h):p.insertBefore(f[1])}else{var g=a.detach(),k=$("#coupons"),v=$(".cat-header");10634==r?($("#subsciption-mod").addClass("frt").css("width","825px"),1===v.length?g.appendTo(k):g.insertBefore(v[1])):$("#subsciption-mod").html(g)}if($("#store-coupons-head").length>0&&t.length>0&&("/_stores/default_landing_merchant/overlay_sem_20111019.htm"===location.pathname?($("#store-coupons-head").after(t.find(".sem-welcome-bonus .sem-bonus-offers")),t.hide(),ebates.cookie.set("sem_20111019",1,30)):ebates.cookie.get("sem_20111019")&&($("#store-coupons-head").after(t.find(".sem-welcome-bonus .sem-bonus-offers")),t.hide())),n.length>0){var w=n.detach();$("#pre-appr-cc").html(w)}if(s.length>0){s.detach().insertAfter("#store-coupons-head")}document.dispatchEvent(new CustomEvent("ajax-module-loaded",{detail:{el:document.getElementById("store-coupons")}}))}})},1e3)}$("a#close_button").click(function(){e()}),$("#return-bonus").is(":visible")||$("h1.heading-main").addClass("border-b-0"),$(".filter-st").on("click",function(){$("div#divisionname_popup").show(),$("#change-st-bg").css({opacity:"0.8"}).fadeIn("slow"),$("#change-st-bg").on("click",function(){$("#change-st-bg").css({display:"none"}),$("div#divisionname_popup").hide()})}),$("#divisionname_popup .store-state span").on("click",function(){var t=$(this).parent("li").data("role");$(".stores-blk").find("div.st_"+t).removeClass("hide").addClass("show").siblings().removeClass("show").addClass("hide"),$(".filter-st").removeClass("show").addClass("hide"),$(".show-all").removeClass("hide").addClass("show"),e()}),$(".show-all").click(function(){$(".stores-blk div,.filter-st").removeClass("hide").addClass("show"),$(this).removeClass("show").addClass("hide")}),$("#qr_code_bb").click(function(){ebates.overlays=ebates.overlays||{};var e=$("#qr_module_bb").clone(!0).addClass("desk-qr");e.css("display","block");var t={classes:{toAdd:["border-grn-t-2"],toRemove:["border-grn-t-5"]}};ebates.js.require(ebates.src.modal,function(){ebates.UI.modal(e,t,{init:function(){jQuery.ajax({url:merLink,type:"GET",dataType:"json",timeout:2e3,error:function(e,t,a){$("#desk_qrcode").text("Failed to connect to server")}}).done(function(a){var o,s,n="",r=a.ticket[0].trackingNumber.length;if(r>0){n=e(30-r,n),n+=a.ticket[0].trackingNumber;var i="05".concat("0006467161").concat(n);o=new Date,s=o.getDate();var l=o.getMonth();l++;var c=" Valid "+l+"/"+s+" Only";$(".vld-text").text(c),$("#desk_qrcode").empty(),ebates.js.require("/mobile_web/stores/merchant_landing/bestbuy/js/jq.qr.min.js",function(){$(".desk-qr .desk_qrcode").qrcode({width:200,height:200,text:i})}),$(".print_module").click(function(){var e=document.getElementById("top-bb"),a=(document.querySelector(".desk_qrcode"),document.getElementById("bot-bb")),o=e.cloneNode(!0),s=a.cloneNode(!0);window.qrcode=o,window.bot_qrcode=s;var n=t(document.querySelector(".desk_qrcode canvas"));window.canvas=n,window.open("/ajax/store/print/qrcode.htm")})}});var e=function(e,t){for(var a=0;a<e;a++)t=t.concat("0");return t},t=function(e){var t=document.createElement("canvas"),a=t.getContext("2d");return t.width=e.width,t.height=e.height,a.drawImage(e,0,0),t}}})})}),"D"==ebates.stats.device&&!ebates.isTieredMerchant&&ebates.getBrowser&&["Chrome","Firefox","Edge","Safari"].indexOf(ebates.getBrowser().name)>=0&&"SignUp"===ebates.user.authType&&!document.querySelector("ebatestoolbar")&&ebates.js.require(ebates.src.store.btn_overlay)})}();
//# sourceMappingURL=store_landing-683c862d6e.js.map
